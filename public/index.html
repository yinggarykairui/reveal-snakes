<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reveal Snakes üêç</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0a0a;
    --surface: #111111;
    --border: #1e1e1e;
    --accent: #39ff14;
    --accent-dim: #1a7a06;
    --snake: #ff4d4d;
    --fan: #ffd700;
    --text: #e8e8e8;
    --muted: #555;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Mono', monospace;
    min-height: 100vh;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(57,255,20,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(57,255,20,0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none;
    z-index: 0;
  }

  .container {
    position: relative;
    z-index: 1;
    max-width: 1100px;
    margin: 0 auto;
    padding: 40px 24px 80px;
  }

  header { text-align: center; margin-bottom: 60px; }

  .title {
    font-family: 'Bebas Neue', cursive;
    font-size: clamp(64px, 12vw, 120px);
    letter-spacing: 0.04em;
    line-height: 1;
    color: var(--accent);
    text-shadow: 0 0 40px rgba(57,255,20,0.4), 0 0 80px rgba(57,255,20,0.15);
    animation: flicker 6s infinite;
  }

  .snake-emoji {
    display: inline-block;
    animation: slither 2s ease-in-out infinite;
  }

  @keyframes slither {
    0%, 100% { transform: rotate(-5deg); }
    50% { transform: rotate(5deg); }
  }

  @keyframes flicker {
    0%, 95%, 100% { opacity: 1; }
    96% { opacity: 0.85; }
    97% { opacity: 1; }
    98% { opacity: 0.9; }
  }

  .subtitle {
    margin-top: 12px;
    color: var(--muted);
    font-size: 13px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
  }

  .instructions {
    background: var(--surface);
    border: 1px solid var(--border);
    border-left: 3px solid var(--accent);
    padding: 16px 20px;
    margin-bottom: 40px;
    font-size: 13px;
    color: #888;
    line-height: 1.7;
  }

  .instructions strong { color: var(--accent); }

  .drop-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 32px;
  }

  @media (max-width: 600px) { .drop-grid { grid-template-columns: 1fr; } }

  .drop-zone {
    border: 2px dashed var(--border);
    border-radius: 2px;
    padding: 40px 24px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    background: var(--surface);
  }

  .drop-zone:hover, .drop-zone.drag-over {
    border-color: var(--accent);
    background: rgba(57,255,20,0.04);
  }

  .drop-zone.loaded { border-color: var(--accent-dim); border-style: solid; }

  .drop-zone input[type="file"] {
    position: absolute;
    inset: 0;
    opacity: 0;
    cursor: pointer;
    width: 100%;
    height: 100%;
  }

  .drop-icon { font-size: 36px; margin-bottom: 12px; display: block; }

  .drop-label {
    font-family: 'Bebas Neue', cursive;
    font-size: 22px;
    letter-spacing: 0.1em;
    color: var(--accent);
    margin-bottom: 8px;
  }

  .drop-hint { font-size: 11px; color: var(--muted); letter-spacing: 0.1em; }
  .drop-status { margin-top: 10px; font-size: 12px; color: var(--accent); min-height: 16px; }

  .btn-reveal {
    display: block;
    width: 100%;
    padding: 20px;
    background: var(--accent);
    color: #000;
    border: none;
    font-family: 'Bebas Neue', cursive;
    font-size: 28px;
    letter-spacing: 0.15em;
    cursor: pointer;
    transition: all 0.2s;
  }

  .btn-reveal:hover {
    background: #4fff25;
    box-shadow: 0 0 30px rgba(57,255,20,0.4);
    transform: translateY(-1px);
  }

  .btn-reveal:disabled {
    background: #1a1a1a;
    color: var(--muted);
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }

  .results { margin-top: 48px; display: none; }
  .results.visible { display: block; }

  .stats-bar {
    display: flex;
    gap: 16px;
    margin-bottom: 48px;
    flex-wrap: wrap;
  }

  .stat {
    background: var(--surface);
    border: 1px solid var(--border);
    padding: 12px 20px;
    flex: 1;
    min-width: 110px;
    text-align: center;
  }

  .stat-num {
    font-family: 'Bebas Neue', cursive;
    font-size: 32px;
    color: var(--accent);
    display: block;
  }

  .stat-num.red  { color: var(--snake); }
  .stat-num.gold { color: var(--fan); text-shadow: 0 0 20px rgba(255,215,0,0.3); }

  .stat-label { font-size: 10px; color: var(--muted); letter-spacing: 0.15em; text-transform: uppercase; }

  .section { margin-bottom: 56px; }

  .section-header {
    display: flex;
    align-items: baseline;
    gap: 16px;
    margin-bottom: 24px;
    padding-bottom: 16px;
    border-bottom: 1px solid var(--border);
  }

  .section-title {
    font-family: 'Bebas Neue', cursive;
    font-size: 36px;
    letter-spacing: 0.05em;
  }

  .section-title.red  { color: var(--snake); }
  .section-title.gold { color: var(--fan); }

  .section-count { font-size: 13px; color: var(--muted); }

  .card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 12px;
  }

  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    padding: 14px 16px;
    display: flex;
    align-items: center;
    gap: 10px;
    animation: fadeIn 0.3s ease both;
    transition: border-color 0.2s, background 0.2s;
  }

  .card.snake-card { border-left: 3px solid var(--snake); }
  .card.snake-card:hover { border-left-color: #ff8080; border-color: #2a2a2a; }

  .card.fan-card { border-left: 3px solid var(--fan); }
  .card.fan-card:hover { border-left-color: #ffe55c; border-color: #2a2a2a; }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(8px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  .card .icon { font-size: 18px; }

  .card-username {
    font-size: 13px;
    color: var(--text);
    word-break: break-all;
    font-weight: 500;
  }

  .empty-state { text-align: center; padding: 60px 20px; color: var(--muted); }
  .empty-state .big { font-size: 48px; margin-bottom: 16px; }
  .empty-state p {
    font-family: 'Bebas Neue', cursive;
    font-size: 24px;
    letter-spacing: 0.1em;
    color: var(--accent);
  }

  .error-msg {
    color: var(--snake);
    font-size: 12px;
    margin-top: 8px;
    padding: 10px 14px;
    border: 1px solid var(--snake);
    background: rgba(255,77,77,0.05);
    display: none;
  }

  .unfollow-section {
    margin-top: 48px;
    padding: 28px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-top: 3px solid var(--snake);
  }

  .unfollow-title {
    font-family: 'Bebas Neue', cursive;
    font-size: 28px;
    color: var(--snake);
    letter-spacing: 0.08em;
    margin-bottom: 8px;
  }

  .unfollow-desc {
    font-size: 12px;
    color: #888;
    line-height: 1.8;
    margin-bottom: 20px;
  }

  .unfollow-desc strong { color: var(--text); }

  .unfollow-controls {
    display: flex;
    gap: 12px;
    align-items: center;
    flex-wrap: wrap;
    margin-bottom: 16px;
  }

  .delay-label { font-size: 12px; color: var(--muted); white-space: nowrap; }

  .delay-input {
    background: #0a0a0a;
    border: 1px solid var(--border);
    color: var(--text);
    font-family: 'DM Mono', monospace;
    font-size: 13px;
    padding: 8px 12px;
    width: 90px;
  }

  .delay-input:focus { outline: none; border-color: var(--snake); }

  .btn-copy {
    padding: 12px 24px;
    background: var(--snake);
    color: #000;
    border: none;
    font-family: 'Bebas Neue', cursive;
    font-size: 20px;
    letter-spacing: 0.1em;
    cursor: pointer;
    transition: all 0.2s;
  }

  .btn-copy:hover {
    background: #ff8080;
    box-shadow: 0 0 20px rgba(255,77,77,0.35);
  }

  .btn-copy.copied {
    background: var(--accent);
    color: #000;
  }

  .script-warning {
    font-size: 11px;
    color: #666;
    border-left: 2px solid var(--snake);
    padding-left: 12px;
    line-height: 1.7;
  }

  .script-warning a { color: var(--snake); }

  .live-counter {
    text-align: center;
    margin-top: 20px;
    font-size: 12px;
    color: var(--muted);
    letter-spacing: 0.12em;
    text-transform: uppercase;
  }

  .live-counter span {
    color: var(--accent);
    font-family: 'Bebas Neue', cursive;
    font-size: 18px;
    letter-spacing: 0.05em;
  }
</style>
</head>
<body>
<div class="container">
  <header>
    <div class="title"><span class="snake-emoji">üêç</span> REVEAL SNAKES</div>
    <div class="subtitle">Instagram Ghost Detector ‚Äî Snakes &amp; Fans</div>
    <div class="subtitle" style="margin-top:8px;font-size:11px;">Made by <a href="https://instagram.com/kairui.mp4" style="color:var(--accent);text-decoration:none;">@kairui.mp4</a> + <a href="https://instagram.com/gary_ying.k" style="color:var(--accent);text-decoration:none;">@gary_ying.k</a></div>
  
  <div class="live-counter" id="live-counter" style="display:none">
    <span id="global-snakes">‚Äî</span> snakes revealed globally &nbsp;¬∑&nbsp; <span id="global-reveals">‚Äî</span> reveals
  </div>
  </header>

  <div class="instructions">
    <strong>HOW TO GET YOUR DATA:</strong> Paste This Link: "<a href="https://accountscenter.instagram.com/info_and_permissions/" target="_blank" style="color:#39ff14;">https://accountscenter.instagram.com/info_and_permissions/</a>" ‚Üí Export your information ‚Üí Create Export ‚Üí Export to Device ‚Üí Date Range ‚Üí All time ‚Üí Start Export (Might take a couple minutes) ‚Üí Once downloaded, unzip and find <strong>followers_1.html</strong> and <strong>following.html</strong> inside the <strong>connections/followers_and_following/</strong> folder.
  </div>

  <div style="margin-bottom: 32px;">
  <div style="font-size:11px;color:#555;letter-spacing:0.15em;text-transform:uppercase;margin-bottom:10px;">
    <strong style="color:#39ff14;">üì∫ WATCH THE GUIDE FIRST</strong> ‚Äî 2 min walkthrough
  </div>
  <div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border:1px solid #1e1e1e;">
    <iframe
      style="position:absolute;top:0;left:0;width:100%;height:100%;border:0;"
      src="https://www.youtube.com/embed/cmxvO6Ym9fg"
      allowfullscreen>
    </iframe>
  </div>
</div>

  <div class="drop-grid">
    <div class="drop-zone" id="zone-followers">
      <input type="file" accept=".html,.htm" id="file-followers">
      <span class="drop-icon">üë•</span>
      <div class="drop-label">Followers File</div>
      <div class="drop-hint">Drop followers_1.html here</div>
      <div class="drop-status" id="status-followers"></div>
    </div>
    <div class="drop-zone" id="zone-following">
      <input type="file" accept=".html,.htm" id="file-following">
      <span class="drop-icon">üîé</span>
      <div class="drop-label">Following File</div>
      <div class="drop-hint">Drop following.html here</div>
      <div class="drop-status" id="status-following"></div>
    </div>
  </div>

  <div class="error-msg" id="error-msg"></div>

  <button class="btn-reveal" id="btn-reveal" disabled>üêç REVEAL THE SNAKES üêç</button>

  <div class="results" id="results">
    <div class="unfollow-section" id="unfollow-section" style="display:none">
      <div class="unfollow-title">‚ò†Ô∏è Auto-Unfollow Script</div>
      <div class="unfollow-desc">
        This generates a script pre-loaded with your snake list. Paste it into the browser console
        on <strong>instagram.com</strong> and it will automatically unfollow each one with a human-like delay.
      </div>
      <div class="unfollow-controls">
        <span class="delay-label">Delay between unfollows (seconds):</span>
        <input class="delay-input" type="number" id="delay-input" value="3" min="1" max="60">
        <button class="btn-copy" id="btn-copy-script">üìã COPY SCRIPT</button>
      </div>
      <div class="script-warning">
        ‚ö†Ô∏è <strong>Use with caution.</strong> Instagram may temporarily restrict your account if you unfollow too many people too quickly.
        A delay of 3‚Äì5 seconds is recommended. Consider running in batches if you have many snakes.
        This runs entirely in your browser ‚Äî no data leaves your device.
      </div>
    </div>
    <div class="stats-bar" id="stats-bar"></div>

    <div class="section">
      <div class="section-header">
        <div class="section-title red">üêç The Snakes</div>
        <div class="section-count" id="snake-count"></div>
      </div>
      <div id="snake-list"></div>
    </div>

    <div class="section">
      <div class="section-header">
        <div class="section-title gold">‚≠ê The Fans</div>
        <div class="section-count" id="fan-count"></div>
      </div>
      <div id="fan-list"></div>
    </div>
  </div>
</div>

<script>
  let followersData = null;
  let followingData = null;

  const NON_USERNAME_PATHS = new Set([
    'p', 'reel', 'reels', 'explore', 'stories', 'tv', 'ar', 'live',
    'accounts', 'about', 'directory', 'legal', 'privacy', 'help',
    'challenge', 'oauth', 'api', 'graphql', 'static', 'emails'
  ]);

  function parseInstagramHTML(html) {
    const parser = new DOMParser();
    const doc = parser.parseFromString(html, 'text/html');
    const usernames = new Set();
    doc.querySelectorAll('a').forEach(a => {
      const href = a.getAttribute('href') || '';
      if (!href.includes('instagram.com/')) return;

      // Primary: _u/ style links used in Instagram exports
      const uMatch = href.match(/instagram\.com\/_u\/([^/?#]+)/);
      if (uMatch && uMatch[1]) {
        usernames.add(uMatch[1].toLowerCase());
        return;
      }

      // Fallback: direct profile links ‚Äî exclude known non-username path segments
      const directMatch = href.match(/instagram\.com\/([^/?#]+)/);
      if (directMatch && directMatch[1]) {
        const segment = directMatch[1].toLowerCase();
        if (!NON_USERNAME_PATHS.has(segment) && /^[a-z0-9_.]+$/.test(segment)) {
          usernames.add(segment);
        }
      }
    });
    return usernames;
  }

  function handleFile(file, type) {
    const reader = new FileReader();
    reader.onload = (e) => {
      try {
        const parsed = parseInstagramHTML(e.target.result);
        if (parsed.size === 0) {
          showError(`Couldn't parse ${type} file. Make sure it's the correct HTML file from Instagram's data export.`);
          return;
        }
        hideError();
        if (type === 'followers') {
          followersData = parsed;
          document.getElementById('status-followers').textContent = `‚úì ${parsed.size} followers loaded`;
          document.getElementById('zone-followers').classList.add('loaded');
        } else {
          followingData = parsed;
          document.getElementById('status-following').textContent = `‚úì ${parsed.size} following loaded`;
          document.getElementById('zone-following').classList.add('loaded');
        }
        checkReady();
      } catch(err) {
        showError('Error reading file: ' + err.message);
      }
    };
    reader.readAsText(file);
  }

  function showError(msg) {
    const el = document.getElementById('error-msg');
    el.textContent = msg;
    el.style.display = 'block';
  }

  function hideError() {
    document.getElementById('error-msg').style.display = 'none';
  }

  function checkReady() {
    document.getElementById('btn-reveal').disabled = !(followersData && followingData);
  }

  ['followers', 'following'].forEach(type => {
    const input = document.getElementById(`file-${type}`);
    const zone  = document.getElementById(`zone-${type}`);
    input.addEventListener('change', (e) => {
      if (e.target.files[0]) handleFile(e.target.files[0], type);
    });
    zone.addEventListener('dragover', (e) => { e.preventDefault(); zone.classList.add('drag-over'); });
    zone.addEventListener('dragleave', () => zone.classList.remove('drag-over'));
    zone.addEventListener('drop', (e) => {
      e.preventDefault();
      zone.classList.remove('drag-over');
      const file = e.dataTransfer.files[0];
      if (file) handleFile(file, type);
    });
  });

  document.getElementById('btn-reveal').addEventListener('click', () => {
    if (!followersData || !followingData) return;

    const PROTECTED = new Set(['kairui.mp4', 'gary_ying.k']);
    const snakes = [...followingData].filter(u => !followersData.has(u) && !PROTECTED.has(u)).sort();
    const fans   = [...followersData].filter(u => !followingData.has(u) && !PROTECTED.has(u)).sort();

    document.getElementById('stats-bar').innerHTML = `
      <div class="stat"><span class="stat-num">${followingData.size}</span><span class="stat-label">Following</span></div>
      <div class="stat"><span class="stat-num">${followersData.size}</span><span class="stat-label">Followers</span></div>
      <div class="stat"><span class="stat-num red">${snakes.length}</span><span class="stat-label">üêç Snakes</span></div>
      <div class="stat"><span class="stat-num gold">${fans.length}</span><span class="stat-label">‚≠ê Fans</span></div>
    `;

    document.getElementById('snake-count').textContent = `${snakes.length} people you follow who don't follow back`;
    document.getElementById('snake-list').innerHTML = snakes.length === 0
      ? `<div class="empty-state"><div class="big">üéâ</div><p>No Snakes ‚Äî Everyone Follows Back!</p></div>`
      : `<div class="card-grid">${snakes.map((u,i) =>
          `<div class="card snake-card" style="animation-delay:${Math.min(i*0.03,1)}s">
            <span class="icon">üêç</span>
            <div class="card-username">${escapeHtml(u)}</div>
          </div>`).join('')}</div>`;

    document.getElementById('fan-count').textContent = `${fans.length} people who follow you that you don't follow back`;
    document.getElementById('fan-list').innerHTML = fans.length === 0
      ? `<div class="empty-state"><div class="big">üò∂</div><p>No Fans ‚Äî You Follow Everyone Back</p></div>`
      : `<div class="card-grid">${fans.map((u,i) =>
          `<div class="card fan-card" style="animation-delay:${Math.min(i*0.03,1)}s">
            <span class="icon">‚≠ê</span>
            <div class="card-username">${escapeHtml(u)}</div>
          </div>`).join('')}</div>`;

    document.getElementById('results').classList.add('visible');
    document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });

    // Store snakes and followers globally for script generation
    window._snakeList = snakes;
    window._followerList = [...followersData];
    if (snakes.length > 0) {
      document.getElementById('unfollow-section').style.display = 'block';
    }

    // Report to backend + update live counter
    fetch('/api/reveal', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ snake_count: snakes.length })
    })
    .then(r => r.json())
    .then(data => updateCounter(data))
    .catch(() => {}); // fail silently ‚Äî never block the UI
  });


  document.getElementById('btn-copy-script').addEventListener('click', () => {
    const snakes = window._snakeList || [];
    const delayMs = Math.round((parseFloat(document.getElementById('delay-input').value) || 3) * 1000);
    if (!snakes.length) return;

    // Build the script using string concatenation to avoid any escaping issues
    const lines = [
      '(async () => {',
      '  const snakes = ' + JSON.stringify(snakes) + ';',
      '  const followers = new Set(' + JSON.stringify(window._followerList || []) + ');',
      '  // Safety guard: never unfollow someone who follows you',
      '  const safeSnakes = snakes.filter(function(u) {',
      '    if (followers.has(u)) { console.warn("\u26A0\uFE0F Skipping @" + u + " ‚Äî they follow you"); return false; }',
      '    return true;',
      '  });',
      '  const delayMs = ' + delayMs + ';',
      '  const sleep = ms => new Promise(r => setTimeout(r, ms));',
      '  const jitter = () => Math.floor(Math.random() * 800) - 400;',
      '',
      '  async function unfollowUser(username) {',
      '    try {',
      '      const profileRes = await fetch("https://www.instagram.com/api/v1/users/web_profile_info/?username=" + username, {',
      '        headers: { "x-ig-app-id": "936619743392459" }',
      '      });',
      '      if (!profileRes.ok) { console.warn("[" + username + "] Profile fetch failed (" + profileRes.status + ")"); return "failed"; }',
      '      const profileData = await profileRes.json();',
      '      const userId = profileData && profileData.data && profileData.data.user && profileData.data.user.id;',
      '      if (!userId) { console.warn("[" + username + "] Could not get user ID"); return "failed"; }',
      '',
      '      const csrf = document.cookie.split("; ").find(function(c){ return c.startsWith("csrftoken="); });',
      '      const csrfToken = csrf ? csrf.split("=")[1] : null;',
      '      if (!csrfToken) { console.error("No CSRF token ‚Äî are you logged into Instagram?"); return "error"; }',
      '',
      '      const unfollowRes = await fetch("https://www.instagram.com/api/v1/friendships/destroy/" + userId + "/", {',
      '        method: "POST",',
      '        headers: {',
      '          "content-type": "application/x-www-form-urlencoded",',
      '          "x-csrftoken": csrfToken,',
      '          "x-ig-app-id": "936619743392459",',
      '          "x-requested-with": "XMLHttpRequest"',
      '        },',
      '        body: "user_id=" + userId',
      '      });',
      '',
      '      if (unfollowRes.ok) { console.log("\u2705 Unfollowed @" + username); return "ok"; }',
      '      else { console.warn("[" + username + "] Unfollow failed (" + unfollowRes.status + ")"); return "failed"; }',
      '    } catch (e) {',
      '      console.error("[" + username + "] Error:", e.message);',
      '      return "error";',
      '    }',
      '  }',
      '',
      '  console.log("\uD83D\uDC0D Starting unfollow of " + safeSnakes.length + " snakes with " + (delayMs/1000) + "s delay...");',
      '  console.log("Type window._stopUnfollow = true at any time to stop.");',
      '  window._stopUnfollow = false;',
      '  var ok = 0, failed = 0;',
      '  for (var i = 0; i < snakes.length; i++) {',
      '    if (window._stopUnfollow) { console.log("\u26D4 Stopped by user."); break; }',
      '    console.log("[" + (i+1) + "/" + safeSnakes.length + "] Unfollowing @" + safeSnakes[i] + "...");',
      '    var result = await unfollowUser(safeSnakes[i]);',
      '    if (result === "ok") ok++; else failed++;',
      '    if (i < safeSnakes.length - 1) await sleep(delayMs + jitter());',
      '  }',
      '  console.log("\u2705 Done. " + ok + " unfollowed, " + failed + " failed.");',
      '})();'
    ];
    const script = lines.join('\n');

    navigator.clipboard.writeText(script).then(() => {
      const btn = document.getElementById('btn-copy-script');
      btn.textContent = '‚úÖ COPIED!';
      btn.classList.add('copied');
      setTimeout(() => {
        btn.textContent = 'üìã COPY SCRIPT';
        btn.classList.remove('copied');
      }, 2500);
    }).catch(() => {
      // Fallback: show in a textarea
      const ta = document.createElement('textarea');
      ta.value = script;
      ta.style.cssText = 'position:fixed;top:10px;left:10px;width:80vw;height:50vh;z-index:9999;font-size:11px;';
      document.body.appendChild(ta);
      ta.select();
      alert('Clipboard blocked ‚Äî the script is selected in the box that appeared. Press Ctrl+C / Cmd+C to copy, then close it.');
    });
  });


  // ‚îÄ‚îÄ Live counter ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function updateCounter(data) {
    if (!data || data.error) return;
    const el = document.getElementById('live-counter');
    document.getElementById('global-snakes').textContent  = Number(data.snakes_found).toLocaleString();
    document.getElementById('global-reveals').textContent = Number(data.reveals).toLocaleString();
    el.style.display = 'block';
  }

  fetch('/api/stats')
    .then(r => r.json())
    .then(data => updateCounter(data))
    .catch(() => {}); // fail silently if running locally without backend

  function escapeHtml(str) {
    return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
  }
</script>
</body>
</html>
